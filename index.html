
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Магазин парфюмерии</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
  h1 { margin-bottom: 10px; }
  #search { margin-bottom: 15px; padding: 8px; width: 100%; max-width: 400px; }
  .product-list, .cart-list { display: flex; flex-wrap: wrap; gap: 15px; }
  .product, .cart-item {
    background: #fff; border: 1px solid #ddd; border-radius: 6px;
    padding: 10px; width: 200px; box-sizing: border-box;
  }
  .product img { width: 100%; height: 150px; object-fit: cover; border-radius: 4px; }
  .product button, #checkout-btn {
    background-color: #0066cc; color: white; border: none;
    padding: 8px 12px; cursor: pointer; margin-top: 8px; border-radius: 4px;
  }
  .product button:hover, #checkout-btn:hover { background-color: #004d99; }
  #cart {
    margin-top: 30px;
    background: #fff; padding: 15px; border-radius: 6px; border: 1px solid #ccc;
    max-width: 450px;
  }
  #cart h2 { margin-top: 0; }
  .cart-item {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px;
  }
  .cart-item span { flex: 1; }
  .cart-item button {
    background: #cc0000; border: none; color: #fff; border-radius: 4px;
    padding: 2px 6px; cursor: pointer;
  }
  .cart-item button:hover { background: #990000; }
  #order-form {
    margin-top: 20px;
    padding: 15px;
    background: #eef6ff;
    border-radius: 6px;
    max-width: 450px;
  }
  #order-form label { display: block; margin-top: 10px; }
  #order-form input, #order-form textarea {
    width: 100%; padding: 8px; box-sizing: border-box;
    margin-top: 4px; border-radius: 4px; border: 1px solid #ccc;
  }
  #order-form button {
    margin-top: 15px; padding: 10px 15px; background: #0066cc;
    color: white; border: none; border-radius: 4px; cursor: pointer;
  }
  #order-form button:hover { background: #004d99; }
  #empty-msg {
    color: #999; font-style: italic;
  }
</style>
</head>
<body>

<h1>Магазин парфюмерии</h1>

<input type="text" id="search" placeholder="Поиск парфюма..." />

<div id="catalog" class="product-list"></div>

<div id="cart">
  <h2>Корзина</h2>
  <div id="cart-items"></div>
  <div id="cart-total"></div>
  <button id="checkout-btn" disabled>Оформить заказ</button>
</div>

<form id="order-form" style="display:none;">
  <h2>Оформление заказа</h2>
  <label for="name">Имя <span style="color:red">*</span></label>
  <input type="text" id="name" required minlength="2" placeholder="Ваше имя" />

  <label for="phone">Телефон <span style="color:red">*</span></label>
  <input type="tel" id="phone" required pattern="^(\+?\d{7,15})$" placeholder="+7XXXXXXXXXX" />
label for="address">Адрес доставки <span style="color:red">*</span></label>
  <textarea id="address" required minlength="5" placeholder="Адрес доставки"></textarea>

  <button type="submit">Отправить заказ</button>
</form>

<script>
  // Исходные данные товаров
  const products = [
    {
      id: 1,
      name: 'Chanel Bleu De Parfum',
      price: 5000,
      image: 'https://i.imgur.com/7t3xoJX.jpg'
    },
    {
      id: 2,
      name: 'Dior Sauvage',
      price: 4500,
      image: 'https://i.imgur.com/Q0y3upA.jpg'
    },
    {
      id: 3,
      name: 'Versace Eros',
      price: 4000,
      image: 'https://i.imgur.com/1tb2mvL.jpg'
    },
    {
      id: 4,
      name: 'Tom Ford Black Orchid',
      price: 6500,
      image: 'https://i.imgur.com/kn9wrBo.jpg'
    },
    {
      id: 5,
      name: 'Gucci Bloom',
      price: 3800,
      image: 'https://i.imgur.com/kDfnG1F.jpg'
    }
  ];

  // Локальное хранилище корзины
  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  const catalogEl = document.getElementById('catalog');
  const searchEl = document.getElementById('search');
  const cartItemsEl = document.getElementById('cart-items');
  const cartTotalEl = document.getElementById('cart-total');
  const checkoutBtn = document.getElementById('checkout-btn');
  const orderForm = document.getElementById('order-form');

  // Отрисовка каталога с поиском
  function renderCatalog(filter = '') {
    catalogEl.innerHTML = '';
    const filtered = products.filter(p => p.name.toLowerCase().includes(filter.toLowerCase()));
    if (filtered.length === 0) {
      catalogEl.innerHTML = '<p>Товары не найдены.</p>';
      return;
    }
    filtered.forEach(p => {
      const productDiv = document.createElement('div');
      productDiv.className = 'product';
      productDiv.innerHTML = `
        <img src="${p.image}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/200x150?text=No+Image'" />
        <h3>${p.name}</h3>
        <p>Цена: ${p.price.toLocaleString('ru-RU')} ₽</p>
        <button data-id="${p.id}">Добавить в корзину</button>
      `;
      catalogEl.appendChild(productDiv);
    });
    // Назначаем обработчики кнопкам
    catalogEl.querySelectorAll('button').forEach(btn => {
      btn.onclick = () => {
        const id = +btn.getAttribute('data-id');
        addToCart(id);
      };
    });
  }

  // Добавление в корзину
  function addToCart(id) {
    const product = products.find(p => p.id === id);
    if (!product) return;
    const cartItem = cart.find(item => item.id === id);
    if (cartItem) {
      cartItem.qty++;
    } else {
      cart.push({ id: product.id, name: product.name, price: product.price, qty: 1 });
    }
    saveCart();
    renderCart();
    checkoutBtn.disabled = false;
  }

  // Сохранить корзину в localStorage
  function saveCart() {
    localStorage.setItem('cart', JSON.stringify(cart));
  }

  // Удалить товар из корзины
  function removeFromCart(id) {
    cart = cart.filter(item => item.id !== id);
    saveCart();
    renderCart();
    if (cart.length === 0) checkoutBtn.disabled = true;
  }

  // Изменить количество товара
  function changeQty(id, delta) {
    const item = cart.find(item => item.id === id);
    if (!item) return;
    item.qty += delta;
    if (item.qty < 1) {
      removeFromCart(id);
      return;
    }
    saveCart();
    renderCart();
  }

  // Отрисовка корзи�
�ы
  function renderCart() {
    cartItemsEl.innerHTML = '';
    if (cart.length === 0) {
      cartItemsEl.innerHTML = '<p id="empty-msg">Корзина пуста.</p>';
      cartTotalEl.textContent = '';
      checkoutBtn.disabled = true;
      return;
    }
    let total = 0;
    cart.forEach(item => {
      total += item.price * item.qty;
      const itemDiv = document.createElement('div');
      itemDiv.className = 'cart-item';
      itemDiv.innerHTML = `
        <span>${item.name} x ${item.qty} = ${ (item.price * item.qty).toLocaleString('ru-RU')} ₽</span>
        <div>
          <button data-action="minus" data-id="${item.id}">−</button>
          <button data-action="plus" data-id="${item.id}">+</button>
          <button data-action="remove" data-id="${item.id}">×</button>
        </div>
      `;
      cartItemsEl.appendChild(itemDiv);
    });
    cartTotalEl.textContent = `Итого: ${total.toLocaleString('ru-RU')} ₽`;
  }

  // Обработчики кнопок изменения количества в корзине
  cartItemsEl.onclick = (e) => {
    if (e.target.tagName !== 'BUTTON') return;
    const id = +e.target.getAttribute('data-id');
    const action = e.target.getAttribute('data-action');
    if (action === 'plus') changeQty(id, +1);
    else if (action === 'minus') changeQty(id, -1);
    else if (action === 'remove') removeFromCart(id);
  };

  // Обработка поиска
  searchEl.oninput = () => {
    renderCatalog(searchEl.value);
  };

  // Показ формы оформления заказа
  checkoutBtn.onclick = () => {
    orderForm.style.display = 'block';
    window.scrollTo({ top: orderForm.offsetTop, behavior: 'smooth' });
  };

  // Валидация и отправка заказа
  orderForm.onsubmit = (e) => {
    e.preventDefault();

    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const address = document.getElementById('address').value.trim();

    if (name.length < 2) {
      alert('Введите корректное имя (не менее 2 символов).');
      return;
    }
    const phoneRe = /^\+?\d{7,15}$/;
    if (!phoneRe.test(phone)) {
      alert('Введите корректный телефон в формате +7XXXXXXXXXX.');
      return;
    }
    if (address.length < 5) {
      alert('Введите полный адрес доставки.');
      return;
    }
    if (cart.length === 0) {
      alert('Корзина пуста. Добавьте товары.');
      return;
    }

    // Формируем текст заказа
    let orderText = `Новый заказ:\n\nИмя: ${name}\nТелефон: ${phone}\nАдрес: ${address}\n\nТовары:\n`;
    cart.forEach(item => {
      orderText += ` - ${item.name} x${item.qty} = ${(item.price * item.qty).toLocaleString('ru-RU')} ₽\n`;
    });
    let total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
    orderText += `\nИтого: ${total.toLocaleString('ru-RU')} ₽`;

    // Здесь можно заменить alert на отправку на сервер или в мессенджер
    alert(orderText);

    // Очистка корзины и формы после заказа
    cart = [];
    saveCart();
    renderCart();
    orderForm.reset();
    orderForm.style.display = 'none';
    checkoutBtn.disabled = true;
  };

  // Инициализация
  renderCatalog();
  renderCart();

</script>

</body>
</html>







